<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8">
<title>SISO: sccc.m Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css">
<link href="doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.5.9 -->
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="index.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="pages.html"><span>Related&nbsp;Pages</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
    <li>
      <form action="search.php" method="get">
        <table cellspacing="0" cellpadding="0" border="0">
          <tr>
            <td><label>&nbsp;<u>S</u>earch&nbsp;for&nbsp;</label></td>
            <td><input type="text" name="query" value="" size="20" accesskey="s"/></td>
          </tr>
        </table>
      </form>
    </li>
    </ul>
  </div>
  <div class="tabs">
    <ul>
      <li><a href="files.html"><span>File&nbsp;List</span></a></li>
      <li><a href="globals.html"><span>File&nbsp;Members</span></a></li>
    </ul>
  </div>
<h1>sccc.m</h1><a href="sccc_8m.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 % -------------------------------------------------------------------
<a name="l00002"></a>00002 % Serial Concatenated Convolutional Codes (SCCC) of coding <a class="code" href="pccc_8m.html#848fd681812403547f43b2f76540cc40">rate</a> 1/3
<a name="l00003"></a>00003 % -------------------------------------------------------------------
<a name="l00004"></a>00004 
<a name="l00005"></a>00005 clear all
<a name="l00006"></a>00006 clc
<a name="l00007"></a>00007 
<a name="l00008"></a>00008 %general parameters
<a name="l00009"></a>00009 <a class="code" href="sccc_8m.html#45dab2ba836856bcc052cbc69bd40adf">threshold</a> = 100;
<a name="l00010"></a><a class="code" href="sccc_8m.html#c44ada9f8f99e5d9f521438b2b6b7b36">00010</a> <a class="code" href="pccc_8m.html#c44ada9f8f99e5d9f521438b2b6b7b36">map_metric</a> = <span class="stringliteral">'logMAP'</span>;
<a name="l00011"></a><a class="code" href="sccc_8m.html#73103af02bc57db44fc54ad21c37ecd9">00011</a> <a class="code" href="pccc_8m.html#73103af02bc57db44fc54ad21c37ecd9">gen</a> = [7 5];%recursive polynomial first
<a name="l00012"></a><a class="code" href="sccc_8m.html#20471f9e7d53f2086dc17d1841207428">00012</a> <a class="code" href="sccc_8m.html#20471f9e7d53f2086dc17d1841207428">outer_code_puncturing_pattern</a> = [1 1 1 1]; 
<a name="l00013"></a><a class="code" href="sccc_8m.html#2db14ef8a33e774589826a6f1e5fe516">00013</a> <a class="code" href="pccc_8m.html#2db14ef8a33e774589826a6f1e5fe516">nb_errors_lim</a> = 3000;
<a name="l00014"></a><a class="code" href="sccc_8m.html#a6ede64af868a0712a6f0a552296fccf">00014</a> <a class="code" href="sccc_8m.html#a6ede64af868a0712a6f0a552296fccf">nb_bits_lim</a> = 1e6;
<a name="l00015"></a><a class="code" href="sccc_8m.html#8b420c46ce5570ef92f50c779dace329">00015</a> <a class="code" href="pccc_8m.html#8b420c46ce5570ef92f50c779dace329">perm_len</a> = 3*pow2(15);%total number of <a class="code" href="pccc_8m.html#e0187e340c2965676e5801e8d1274c3b">bits</a> in a <a class="code" href="pccc_8m.html#71f0a2190b4d07a9c41d2681c64085c9">block</a>
<a name="l00016"></a><a class="code" href="sccc_8m.html#be1b5217ffb43e4e6fae98a2910d9da0">00016</a> <a class="code" href="pccc_8m.html#be1b5217ffb43e4e6fae98a2910d9da0">nb_iter</a> = 10;%number of iterations in the turbo <a class="code" href="pccc_8m.html#5d4675ccc38f894c78ef8a732de07c85">decoder</a>
<a name="l00017"></a><a class="code" href="sccc_8m.html#bc716b49b0c9588d89d80534d0b0b8ca">00017</a> <a class="code" href="pccc_8m.html#bc716b49b0c9588d89d80534d0b0b8ca">EbN0_dB</a> = 0:0.1:5;
<a name="l00018"></a><a class="code" href="sccc_8m.html#67abf79962819ebcd2be7e4adb72a646">00018</a> <a class="code" href="sccc_8m.html#67abf79962819ebcd2be7e4adb72a646">Ec</a> = 1;%coded bit energy
<a name="l00019"></a>00019 
<a name="l00020"></a>00020 %other parameters
<a name="l00021"></a><a class="code" href="sccc_8m.html#49a69b5721f6137c804deb5db827f20f">00021</a> <a class="code" href="pccc_8m.html#49a69b5721f6137c804deb5db827f20f">bin_gen</a> = de2bi(base2dec(int2str(<a class="code" href="pccc_8m.html#73103af02bc57db44fc54ad21c37ecd9">gen</a>.<span class="stringliteral">'), 8), '</span>left-msb<span class="stringliteral">');</span>
<a name="l00022"></a><a class="code" href="sccc_8m.html#e956324643206ec3d34fd8023e6217b8">00022</a> <span class="stringliteral">code_outputs = length(gen);</span>
<a name="l00023"></a><a class="code" href="sccc_8m.html#93bc23fcea3f4ac48fabf9d13d306465">00023</a> <span class="stringliteral">outer_code_rate = (length(outer_code_puncturing_pattern)/code_outputs)/...</span>
<a name="l00024"></a>00024 <span class="stringliteral">    length(find(outer_code_puncturing_pattern~=0));</span>
<a name="l00025"></a><a class="code" href="sccc_8m.html#1983415e685b3fa7812c57a4a9bd282c">00025</a> <span class="stringliteral">inner_code_rate = 1/length(gen);</span>
<a name="l00026"></a><a class="code" href="sccc_8m.html#24ee4b5453385f9ba93ead2a9623c539">00026</a> <span class="stringliteral">R = outer_code_rate*inner_code_rate;%coding rate of the SCCC</span>
<a name="l00027"></a><a class="code" href="sccc_8m.html#a9ed8a59f01263a17ca75f8ec6439429">00027</a> <span class="stringliteral">constraint_len = size ( bin_gen, 2 );</span>
<a name="l00028"></a><a class="code" href="sccc_8m.html#3ad5b004da0cd6ddb1b60b32ea64a049">00028</a> <span class="stringliteral">sova_win_len = 5*constraint_len;</span>
<a name="l00029"></a><a class="code" href="sccc_8m.html#2ff994e16bf9521154de4cf659a3b689">00029</a> <span class="stringliteral">filename = ['</span>Res/sccc5_<span class="stringliteral">' map_metric  '</span>_<span class="stringliteral">' num2str(gen(1)) '</span>_<span class="stringliteral">' num2str(gen(2)) '</span>.mat<span class="stringliteral">'];</span>
<a name="l00030"></a><a class="code" href="sccc_8m.html#de1bd2bef086e1aa50b191df66e098ef">00030</a> <span class="stringliteral">sigma2 = (0.5*Ec/R)*10.^(-EbN0_dB/10);%N0/2</span>
<a name="l00031"></a><a class="code" href="sccc_8m.html#3c335a50571e94ea8fdc5fcef0f4fa31">00031</a> <span class="stringliteral">perm = zeros(1, perm_len);</span>
<a name="l00032"></a><a class="code" href="sccc_8m.html#156500bafa74c8b4e14d4ac7b796870e">00032</a> <span class="stringliteral">inv_perm = zeros(1, perm_len);</span>
<a name="l00033"></a><a class="code" href="sccc_8m.html#590feebedbb1efacea3adb1d38c4ab9f">00033</a> <span class="stringliteral">nb_bits = perm_len*outer_code_rate;</span>
<a name="l00034"></a><a class="code" href="sccc_8m.html#47e626bd092a845f9b0e9d4cc789ba89">00034</a> <span class="stringliteral">rec_len = perm_len/inner_code_rate;</span>
<a name="l00035"></a>00035 <span class="stringliteral">if (int32(nb_bits)~=nb_bits) || (int32(rec_len)~=rec_len)</span>
<a name="l00036"></a>00036 <span class="stringliteral">    error('</span>sccc<span class="stringliteral">', '</span>specified <a class="code" href="pccc_8m.html#0a592553caeb5919316774d98ae39046">permutation</a> length, %d, does not accept these <a class="code" href="BICM_8m.html#0a08ab68c0f87fff46d52eceece724e2">code</a> rates, %d, %d<span class="stringliteral">', ...</span>
<a name="l00037"></a>00037 <span class="stringliteral">        outer_code_rate, inner_code_rate);</span>
<a name="l00038"></a>00038 <span class="stringliteral">end</span>
<a name="l00039"></a><a class="code" href="sccc_8m.html#eaa314e3e8f58e76f67af8ec38576bf1">00039</a> <span class="stringliteral">rec = zeros(1, rec_len);</span>
<a name="l00040"></a><a class="code" href="sccc_8m.html#3e0c587293fb69391a99077d4f75a10c">00040</a> <span class="stringliteral">snr_len = length(EbN0_dB);</span>
<a name="l00041"></a><a class="code" href="sccc_8m.html#4799e2ea2eeaf9ebc68bd4468b682670">00041</a> <span class="stringliteral">BER = zeros(nb_iter, snr_len);</span>
<a name="l00042"></a><a class="code" href="sccc_8m.html#2efe08d7422cd7e9444232ddb15a4ef0">00042</a> <span class="stringliteral">expanded_puncturing_pattern = logical(kron(ones(1, code_outputs*nb_bits/length(outer_code_puncturing_pattern)), ...</span>
<a name="l00043"></a>00043 <span class="stringliteral">    outer_code_puncturing_pattern));</span>
<a name="l00044"></a><a class="code" href="sccc_8m.html#816b4e0667904c6ebd02c712f2eb7569">00044</a> <span class="stringliteral">inner_code_extrinsic_data = zeros(1, perm_len);</span>
<a name="l00045"></a><a class="code" href="sccc_8m.html#b24e387b1e07a05c1a6900a680fedcca">00045</a> <span class="stringliteral">outer_code_apriori_data = zeros(1, nb_bits);</span>
<a name="l00046"></a><a class="code" href="sccc_8m.html#e51f63abac3048c200f8c5123ce5cf77">00046</a> <span class="stringliteral">outer_code_intrinsic_coded = zeros(1, nb_bits*code_outputs);</span>
<a name="l00047"></a>00047 <span class="stringliteral"></span>
<a name="l00048"></a>00048 <span class="stringliteral">%Recursive Systematic Convolutional Code trellis</span>
<a name="l00049"></a><a class="code" href="sccc_8m.html#87fd397cb83e9c933b52ff95c211a6f9">00049</a> <span class="stringliteral">trellis = poly2trellis(constraint_len, gen, gen(1));</span>
<a name="l00050"></a>00050 <span class="stringliteral"></span>
<a name="l00051"></a>00051 <span class="stringliteral">%main loop</span>
<a name="l00052"></a><a class="code" href="sccc_8m.html#7bfe56f869281663979e51c992e67fc6">00052</a> <span class="stringliteral">txtprogressbar;</span>
<a name="l00053"></a><a class="code" href="sccc_8m.html#641c8e8a1b707a8601b29dd709a417d4">00053</a> <span class="stringliteral">for en=1:snr_len</span>
<a name="l00054"></a>00054 <span class="stringliteral">    nb_errors = 0;</span>
<a name="l00055"></a><a class="code" href="sccc_8m.html#6be9b04507ad0bb91369acb32a22694b">00055</a> <span class="stringliteral">    nb_blocks = 0;</span>
<a name="l00056"></a>00056 <span class="stringliteral">    while ((nb_errors&lt;nb_errors_lim) &amp;&amp; (nb_blocks*perm_len&lt;nb_bits_lim))</span>
<a name="l00057"></a>00057 <span class="stringliteral">        %permutation</span>
<a name="l00058"></a>00058 <span class="stringliteral">        perm = randperm(perm_len);</span>
<a name="l00059"></a>00059 <span class="stringliteral">        %inverse permutation</span>
<a name="l00060"></a><a class="code" href="sccc_8m.html#0a592553caeb5919316774d98ae39046">00060</a> <span class="stringliteral">        [ignore, inv_perm] = sort(perm);</span>
<a name="l00061"></a>00061 <span class="stringliteral"></span>
<a name="l00062"></a>00062 <span class="stringliteral">        %bits generation</span>
<a name="l00063"></a><a class="code" href="sccc_8m.html#e0187e340c2965676e5801e8d1274c3b">00063</a> <span class="stringliteral">        bits = randint(1, nb_bits, 2);</span>
<a name="l00064"></a>00064 <span class="stringliteral"></span>
<a name="l00065"></a>00065 <span class="stringliteral">        %serial concatenated convolutional code</span>
<a name="l00066"></a><a class="code" href="sccc_8m.html#f78ef0e37e7fb8bc7e29d55d92ad055f">00066</a> <span class="stringliteral">        temp = convenc(bits, trellis, 0);%initial state is zero</span>
<a name="l00067"></a><a class="code" href="sccc_8m.html#0525e11acc750e9dea8966f947d37c75">00067</a> <span class="stringliteral">        outer_code_bits = temp(expanded_puncturing_pattern);%puncturing</span>
<a name="l00068"></a><a class="code" href="sccc_8m.html#f978a949c850f74b33d443d08d3e3c74">00068</a> <span class="stringliteral">        inner_code_bits = convenc(outer_code_bits(perm), trellis, 0);</span>
<a name="l00069"></a>00069 <span class="stringliteral"></span>
<a name="l00070"></a>00070 <span class="stringliteral">        %BPSK modulation (1-&gt;-1,0-&gt;+1) + AWGN channel</span>
<a name="l00071"></a>00071 <span class="stringliteral">        rec = (1-2*inner_code_bits)+sqrt(sigma2(en))*randn(1, rec_len);</span>
<a name="l00072"></a>00072 <span class="stringliteral">        </span>
<a name="l00073"></a>00073 <span class="stringliteral">        %turbo decoder</span>
<a name="l00074"></a><a class="code" href="sccc_8m.html#ba08d4c70e9b3c93d74140ebb765cd95">00074</a> <span class="stringliteral">        inner_code_apriori_data = zeros(1, perm_len);%a priori LLR for information bits</span>
<a name="l00075"></a><a class="code" href="sccc_8m.html#7366315c21737b52c26decb7aee931d5">00075</a> <span class="stringliteral">        inner_code_intrinsic_coded = (-2/sigma2(en))*rec;</span>
<a name="l00076"></a><a class="code" href="sccc_8m.html#4c2d80ab32fc3a598413ae25e9f2bdce">00076</a> <span class="stringliteral">        for n=1:nb_iter</span>
<a name="l00077"></a>00077 <span class="stringliteral">            </span>
<a name="l00078"></a>00078 <span class="stringliteral">            %inner decoder</span>
<a name="l00079"></a>00079 <span class="stringliteral">            [inner_code_extrinsic_parity inner_code_extrinsic_data] = ...</span>
<a name="l00080"></a>00080 <span class="stringliteral">                C_SISOrsc(inner_code_intrinsic_coded, inner_code_apriori_data, bin_gen, 0, map_metric);%no tail            </span>
<a name="l00081"></a>00081 <span class="stringliteral">            </span>
<a name="l00082"></a>00082 <span class="stringliteral">            %deinterleave</span>
<a name="l00083"></a>00083 <span class="stringliteral">            outer_code_intrinsic_coded(expanded_puncturing_pattern) = ...</span>
<a name="l00084"></a>00084 <span class="stringliteral">                inner_code_extrinsic_data(inv_perm);</span>
<a name="l00085"></a>00085 <span class="stringliteral">            </span>
<a name="l00086"></a>00086 <span class="stringliteral">            %outer decoder</span>
<a name="l00087"></a><a class="code" href="sccc_8m.html#0da5aad9cb59e2e899630d55d5c3d7aa">00087</a> <span class="stringliteral">            [outer_code_extrinsic_parity outer_code_extrinsic_data] = ...</span>
<a name="l00088"></a>00088 <span class="stringliteral">                C_SISOrsc(outer_code_intrinsic_coded, outer_code_apriori_data, bin_gen, 0, map_metric);%no tail</span>
<a name="l00089"></a>00089 <span class="stringliteral">            </span>
<a name="l00090"></a>00090 <span class="stringliteral">            %deinterleave for the next iteration</span>
<a name="l00091"></a>00091 <span class="stringliteral">            temp(1:2:end) = outer_code_extrinsic_data;</span>
<a name="l00092"></a>00092 <span class="stringliteral">            temp(2:2:end) = outer_code_extrinsic_parity;</span>
<a name="l00093"></a><a class="code" href="sccc_8m.html#835865ffa4a194c93b68e552436d5763">00093</a> <span class="stringliteral">            temp2 = temp(expanded_puncturing_pattern);</span>
<a name="l00094"></a>00094 <span class="stringliteral">            inner_code_apriori_data = temp2(perm);</span>
<a name="l00095"></a>00095 <span class="stringliteral">            </span>
<a name="l00096"></a>00096 <span class="stringliteral">            %threshold</span>
<a name="l00097"></a>00097 <span class="stringliteral">            inner_code_apriori_data(inner_code_apriori_data&gt;threshold) = threshold;</span>
<a name="l00098"></a>00098 <span class="stringliteral">            inner_code_apriori_data(inner_code_apriori_data&lt;-threshold) = -threshold;</span>
<a name="l00099"></a>00099 <span class="stringliteral">            </span>
<a name="l00100"></a>00100 <span class="stringliteral">            %count errors</span>
<a name="l00101"></a><a class="code" href="sccc_8m.html#d083a0d1052d3a1c7736d2022376817b">00101</a> <span class="stringliteral">            rec_bits = double(outer_code_extrinsic_data&gt;0);</span>
<a name="l00102"></a>00102 <span class="stringliteral">            BER(n,en) = BER(n,en)+nnz(bits-rec_bits)/nb_bits;</span>
<a name="l00103"></a>00103 <span class="stringliteral"></span>
<a name="l00104"></a>00104 <span class="stringliteral">        end%end iterations</span>
<a name="l00105"></a><a class="code" href="sccc_8m.html#f7e56af625de7654082e405f017b4d9d">00105</a> <span class="stringliteral">        nb_errors = nb_errors+nnz(bits-rec_bits);%get number of errors at the last iteration</span>
<a name="l00106"></a>00106 <span class="stringliteral">        nb_blocks = nb_blocks+1;</span>
<a name="l00107"></a>00107 <span class="stringliteral">    end%end blocks (while loop)</span>
<a name="l00108"></a>00108 <span class="stringliteral"></span>
<a name="l00109"></a>00109 <span class="stringliteral">    %compute BER over all tx blocks</span>
<a name="l00110"></a>00110 <span class="stringliteral">    BER(:,en) = BER(:,en)/nb_blocks;</span>
<a name="l00111"></a>00111 <span class="stringliteral"></span>
<a name="l00112"></a>00112 <span class="stringliteral">    %show progress</span>
<a name="l00113"></a>00113 <span class="stringliteral">    txtprogressbar(en/snr_len);</span>
<a name="l00114"></a>00114 <span class="stringliteral">end</span>
<a name="l00115"></a>00115 <span class="stringliteral"></span>
<a name="l00116"></a>00116 <span class="stringliteral">figure</span>
<a name="l00117"></a>00117 <span class="stringliteral">semilogy(EbN0_dB, BER, '</span>o-<span class="stringliteral">')</span>
<a name="l00118"></a>00118 <span class="stringliteral">grid on</span>
<a name="l00119"></a>00119 <span class="stringliteral">xlabel('</span>E_b/N_0 [dB]<span class="stringliteral">')</span>
<a name="l00120"></a>00120 <span class="stringliteral">ylabel('</span><a class="code" href="pccc_8m.html#4799e2ea2eeaf9ebc68bd4468b682670">BER</a><span class="stringliteral">')</span>
<a name="l00121"></a>00121 <span class="stringliteral"></span>
<a name="l00122"></a>00122 <span class="stringliteral">save(filename, '</span><a class="code" href="pccc_8m.html#4799e2ea2eeaf9ebc68bd4468b682670">BER</a><span class="stringliteral">', '</span><a class="code" href="pccc_8m.html#bc716b49b0c9588d89d80534d0b0b8ca">EbN0_dB</a><span class="stringliteral">', '</span><a class="code" href="pccc_8m.html#73103af02bc57db44fc54ad21c37ecd9">gen</a><span class="stringliteral">', '</span><a class="code" href="pccc_8m.html#24ee4b5453385f9ba93ead2a9623c539">R</a><span class="stringliteral">', '</span><a class="code" href="pccc_8m.html#be1b5217ffb43e4e6fae98a2910d9da0">nb_iter</a><span class="stringliteral">', ...</span>
<a name="l00123"></a>00123 <span class="stringliteral">    '</span><a class="code" href="pccc_8m.html#8b420c46ce5570ef92f50c779dace329">perm_len</a><span class="stringliteral">', '</span><a class="code" href="pccc_8m.html#2db14ef8a33e774589826a6f1e5fe516">nb_errors_lim</a><span class="stringliteral">', '</span><a class="code" href="sccc_8m.html#a6ede64af868a0712a6f0a552296fccf">nb_bits_lim</a><span class="stringliteral">', '</span><a class="code" href="sccc_8m.html#20471f9e7d53f2086dc17d1841207428">outer_code_puncturing_pattern</a><span class="stringliteral">')</span>
</pre></div></div>
<hr size="1"><address style="text-align: right;"><small><a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border="0"></a> </small></address>
</body>
</html>
