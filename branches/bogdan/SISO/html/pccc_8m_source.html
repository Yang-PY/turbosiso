<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8">
<title>SISO: pccc.m Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css">
<link href="doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.5.9 -->
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="index.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="pages.html"><span>Related&nbsp;Pages</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
    <li>
      <form action="search.php" method="get">
        <table cellspacing="0" cellpadding="0" border="0">
          <tr>
            <td><label>&nbsp;<u>S</u>earch&nbsp;for&nbsp;</label></td>
            <td><input type="text" name="query" value="" size="20" accesskey="s"/></td>
          </tr>
        </table>
      </form>
    </li>
    </ul>
  </div>
  <div class="tabs">
    <ul>
      <li><a href="files.html"><span>File&nbsp;List</span></a></li>
      <li><a href="globals.html"><span>File&nbsp;Members</span></a></li>
    </ul>
  </div>
<h1>pccc.m</h1><a href="pccc_8m.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 % -------------------------------------------------------------------
<a name="l00002"></a>00002 % Parallel Concatenated Convolutional Codes (PCCC) of coding <a class="code" href="pccc_8m.html#848fd681812403547f43b2f76540cc40">rate</a> 1/3
<a name="l00003"></a>00003 % -------------------------------------------------------------------
<a name="l00004"></a>00004 % Reference: S. Benedetto, D. Divsalar, G. Motorsi and F. Pollara, 
<a name="l00005"></a>00005 % "A Soft-Input Soft-Output Maximum A posteriori (MAP) Module
<a name="l00006"></a>00006 % to Decode Parallel and Serial Concatenated Codes", TDA Progress Report, Nov. 1996
<a name="l00007"></a>00007 
<a name="l00008"></a>00008 clear all
<a name="l00009"></a>00009 clc
<a name="l00010"></a>00010 
<a name="l00011"></a>00011 %general parameters
<a name="l00012"></a>00012 threshold = 100;
<a name="l00013"></a><a class="code" href="pccc_8m.html#c44ada9f8f99e5d9f521438b2b6b7b36">00013</a> <a class="code" href="pccc_8m.html#c44ada9f8f99e5d9f521438b2b6b7b36">map_metric</a> = <span class="stringliteral">'maxlogMAP'</span>;
<a name="l00014"></a><a class="code" href="pccc_8m.html#73103af02bc57db44fc54ad21c37ecd9">00014</a> %<a class="code" href="pccc_8m.html#73103af02bc57db44fc54ad21c37ecd9">gen</a> = [13 15];%first polynomial is the feedback polynomial
<a name="l00015"></a>00015 <a class="code" href="pccc_8m.html#73103af02bc57db44fc54ad21c37ecd9">gen</a> = [37 21];
<a name="l00016"></a>00016 %<a class="code" href="pccc_8m.html#73103af02bc57db44fc54ad21c37ecd9">gen</a> = [7 5];
<a name="l00017"></a><a class="code" href="pccc_8m.html#2db14ef8a33e774589826a6f1e5fe516">00017</a> <a class="code" href="pccc_8m.html#2db14ef8a33e774589826a6f1e5fe516">nb_errors_lim</a> = 3000;
<a name="l00018"></a><a class="code" href="pccc_8m.html#b1164bab531071886b608ea563393d26">00018</a> <a class="code" href="pccc_8m.html#b1164bab531071886b608ea563393d26">perm_len_lim</a> = 1e6;
<a name="l00019"></a><a class="code" href="pccc_8m.html#8b420c46ce5570ef92f50c779dace329">00019</a> <a class="code" href="pccc_8m.html#8b420c46ce5570ef92f50c779dace329">perm_len</a> = pow2(16);%total number of <a class="code" href="pccc_8m.html#e0187e340c2965676e5801e8d1274c3b">bits</a> in a <a class="code" href="pccc_8m.html#71f0a2190b4d07a9c41d2681c64085c9">block</a> (with <a class="code" href="BICM_8m.html#b7e6457c76e27665f870ba871113ec1d">tail</a>)
<a name="l00020"></a>00020 <a class="code" href="pccc_8m.html#be1b5217ffb43e4e6fae98a2910d9da0">nb_iter</a> = 10;%number of iterations in the turbo <a class="code" href="pccc_8m.html#5d4675ccc38f894c78ef8a732de07c85">decoder</a>
<a name="l00021"></a><a class="code" href="pccc_8m.html#bc716b49b0c9588d89d80534d0b0b8ca">00021</a> <a class="code" href="pccc_8m.html#bc716b49b0c9588d89d80534d0b0b8ca">EbN0_dB</a> = 0:0.1:5;
<a name="l00022"></a><a class="code" href="pccc_8m.html#24ee4b5453385f9ba93ead2a9623c539">00022</a> <a class="code" href="pccc_8m.html#24ee4b5453385f9ba93ead2a9623c539">R</a> = 1/3;%coding <a class="code" href="pccc_8m.html#848fd681812403547f43b2f76540cc40">rate</a> (non punctured PCCC)
<a name="l00023"></a>00023 <a class="code" href="sccc_8m.html#67abf79962819ebcd2be7e4adb72a646">Ec</a> = 1;%coded bit energy
<a name="l00024"></a>00024 
<a name="l00025"></a>00025 %other parameters
<a name="l00026"></a><a class="code" href="pccc_8m.html#49a69b5721f6137c804deb5db827f20f">00026</a> <a class="code" href="pccc_8m.html#49a69b5721f6137c804deb5db827f20f">bin_gen</a> = de2bi(base2dec(int2str(<a class="code" href="pccc_8m.html#73103af02bc57db44fc54ad21c37ecd9">gen</a>.<span class="stringliteral">'), 8), '</span>left-msb<span class="stringliteral">');</span>
<a name="l00027"></a><a class="code" href="pccc_8m.html#313bbe9d755acc3e7b7d84c9728a12a6">00027</a> <span class="stringliteral">constraint_len = size ( bin_gen, 2 );</span>
<a name="l00028"></a><a class="code" href="pccc_8m.html#3ad5b004da0cd6ddb1b60b32ea64a049">00028</a> <span class="stringliteral">sova_win_len = 5*constraint_len;</span>
<a name="l00029"></a><a class="code" href="pccc_8m.html#2ff994e16bf9521154de4cf659a3b689">00029</a> <span class="stringliteral">filename = ['</span>Res/pccc_<span class="stringliteral">' map_metric  '</span>_<span class="stringliteral">' num2str(gen(1)) '</span>_<span class="stringliteral">' num2str(gen(2)) '</span>.mat<span class="stringliteral">'];</span>
<a name="l00030"></a><a class="code" href="pccc_8m.html#de1bd2bef086e1aa50b191df66e098ef">00030</a> <span class="stringliteral">sigma2 = (0.5*Ec/R)*10.^(-EbN0_dB/10);%N0/2</span>
<a name="l00031"></a><a class="code" href="pccc_8m.html#3c335a50571e94ea8fdc5fcef0f4fa31">00031</a> <span class="stringliteral">perm = zeros(1, perm_len);</span>
<a name="l00032"></a><a class="code" href="pccc_8m.html#156500bafa74c8b4e14d4ac7b796870e">00032</a> <span class="stringliteral">inv_perm = zeros(1, perm_len);</span>
<a name="l00033"></a><a class="code" href="pccc_8m.html#a48335a8df1a1ef86b7ce3ba379e680d">00033</a> <span class="stringliteral">cod_bits_len = perm_len*length(gen);</span>
<a name="l00034"></a><a class="code" href="pccc_8m.html#47e626bd092a845f9b0e9d4cc789ba89">00034</a> <span class="stringliteral">rec_len = perm_len/R;</span>
<a name="l00035"></a><a class="code" href="pccc_8m.html#d358daea1b1564160f38d589e1168a33">00035</a> <span class="stringliteral">coded_bits = zeros(1, rec_len);</span>
<a name="l00036"></a><a class="code" href="pccc_8m.html#7c8cb9c29630901b8b5da4cdd7401d36">00036</a> <span class="stringliteral">rec = zeros(1, rec_len);</span>
<a name="l00037"></a><a class="code" href="pccc_8m.html#7a4b02836ae484871b7ab06d58261328">00037</a> <span class="stringliteral">dec1_intrinsic_coded = zeros(1, cod_bits_len);</span>
<a name="l00038"></a><a class="code" href="pccc_8m.html#d7b06070d6f06fad6483193bfcad2d99">00038</a> <span class="stringliteral">dec2_intrinsic_coded = zeros(1, cod_bits_len);</span>
<a name="l00039"></a><a class="code" href="pccc_8m.html#bc74e57618657634faf61de23a2d1d0c">00039</a> <span class="stringliteral">extrinsic_coded = zeros(1, perm_len);</span>
<a name="l00040"></a><a class="code" href="pccc_8m.html#5281907479deebb2221449a1a435e6f9">00040</a> <span class="stringliteral">extrinsic_data = zeros(1, perm_len);</span>
<a name="l00041"></a><a class="code" href="pccc_8m.html#3e0c587293fb69391a99077d4f75a10c">00041</a> <span class="stringliteral">snr_len = length(EbN0_dB);</span>
<a name="l00042"></a><a class="code" href="pccc_8m.html#4799e2ea2eeaf9ebc68bd4468b682670">00042</a> <span class="stringliteral">BER = zeros(nb_iter, snr_len);</span>
<a name="l00043"></a>00043 <span class="stringliteral"></span>
<a name="l00044"></a>00044 <span class="stringliteral">%Recursive Systematic Convolutional Code trellis</span>
<a name="l00045"></a><a class="code" href="pccc_8m.html#87fd397cb83e9c933b52ff95c211a6f9">00045</a> <span class="stringliteral">trellis = poly2trellis(constraint_len, gen, gen(1));</span>
<a name="l00046"></a>00046 <span class="stringliteral"></span>
<a name="l00047"></a>00047 <span class="stringliteral">%main loop</span>
<a name="l00048"></a><a class="code" href="pccc_8m.html#7bfe56f869281663979e51c992e67fc6">00048</a> <span class="stringliteral">txtprogressbar;</span>
<a name="l00049"></a><a class="code" href="pccc_8m.html#641c8e8a1b707a8601b29dd709a417d4">00049</a> <span class="stringliteral">for en=1:snr_len</span>
<a name="l00050"></a>00050 <span class="stringliteral">    nb_errors = 0;</span>
<a name="l00051"></a><a class="code" href="pccc_8m.html#6be9b04507ad0bb91369acb32a22694b">00051</a> <span class="stringliteral">    nb_blocks = 0;</span>
<a name="l00052"></a>00052 <span class="stringliteral">    while ((nb_errors&lt;nb_errors_lim) &amp;&amp; (nb_blocks*perm_len&lt;perm_len_lim))</span>
<a name="l00053"></a>00053 <span class="stringliteral">        %permutation</span>
<a name="l00054"></a>00054 <span class="stringliteral">        perm = randperm(perm_len);</span>
<a name="l00055"></a>00055 <span class="stringliteral">        %inverse permutation</span>
<a name="l00056"></a><a class="code" href="pccc_8m.html#0a592553caeb5919316774d98ae39046">00056</a> <span class="stringliteral">        [ignore, inv_perm] = sort(perm);</span>
<a name="l00057"></a>00057 <span class="stringliteral"></span>
<a name="l00058"></a>00058 <span class="stringliteral">        %bits generation</span>
<a name="l00059"></a><a class="code" href="pccc_8m.html#e0187e340c2965676e5801e8d1274c3b">00059</a> <span class="stringliteral">        bits = randint(1, perm_len, 2);</span>
<a name="l00060"></a>00060 <span class="stringliteral"></span>
<a name="l00061"></a>00061 <span class="stringliteral">        %parallel concatenated convolutional code</span>
<a name="l00062"></a><a class="code" href="pccc_8m.html#49b4c7b1427fb8cc25479d8f7a6e4f09">00062</a> <span class="stringliteral">        cod1_bits = convenc(bits, trellis, 0);%initial state is zero</span>
<a name="l00063"></a><a class="code" href="pccc_8m.html#dd2ce49c679d6cdb0320221dd8ca5898">00063</a> <span class="stringliteral">        cod2_bits = convenc(bits(perm), trellis, 0);</span>
<a name="l00064"></a>00064 <span class="stringliteral">        </span>
<a name="l00065"></a>00065 <span class="stringliteral">        %multiplexer</span>
<a name="l00066"></a>00066 <span class="stringliteral">        coded_bits(1:3:end) = bits;</span>
<a name="l00067"></a>00067 <span class="stringliteral">        coded_bits(2:3:end) = cod1_bits(2:2:end);</span>
<a name="l00068"></a>00068 <span class="stringliteral">        coded_bits(3:3:end) = cod2_bits(2:2:end);</span>
<a name="l00069"></a>00069 <span class="stringliteral"></span>
<a name="l00070"></a>00070 <span class="stringliteral">        %BPSK modulation (1-&gt;-1,0-&gt;+1) + AWGN channel</span>
<a name="l00071"></a>00071 <span class="stringliteral">        rec = (1-2*coded_bits)+sqrt(sigma2(en))*randn(1, rec_len);</span>
<a name="l00072"></a>00072 <span class="stringliteral"></span>
<a name="l00073"></a>00073 <span class="stringliteral">        %form input for SISO blocks</span>
<a name="l00074"></a>00074 <span class="stringliteral">        dec1_intrinsic_coded(1:2:end) = -2/sigma2(en)*rec(1:3:end);</span>
<a name="l00075"></a>00075 <span class="stringliteral">        dec1_intrinsic_coded(2:2:end) = -2/sigma2(en)*rec(2:3:end);</span>
<a name="l00076"></a>00076 <span class="stringliteral">        dec2_intrinsic_coded(2:2:end) = -2/sigma2(en)*rec(3:3:end);</span>
<a name="l00077"></a>00077 <span class="stringliteral">        </span>
<a name="l00078"></a>00078 <span class="stringliteral">        %turbo decoder</span>
<a name="l00079"></a><a class="code" href="pccc_8m.html#538daf4079e02293176bdde2a829700f">00079</a> <span class="stringliteral">        apriori_data = zeros(1, perm_len);%a priori LLR for information bits</span>
<a name="l00080"></a><a class="code" href="pccc_8m.html#b16835ef8374501899a0b3db115584fc">00080</a> <span class="stringliteral">        for n=1:nb_iter</span>
<a name="l00081"></a>00081 <span class="stringliteral">            </span>
<a name="l00082"></a>00082 <span class="stringliteral">            %first decoder</span>
<a name="l00083"></a>00083 <span class="stringliteral">            [extrinsic_coded extrinsic_data] = ...</span>
<a name="l00084"></a>00084 <span class="stringliteral">                C_SISOrsc(dec1_intrinsic_coded, apriori_data, bin_gen, 0, map_metric);%no tail</span>
<a name="l00085"></a>00085 <span class="stringliteral">            %extrinsic_data = C_SISOsova(dec1_intrinsic_coded, apriori_data, bin_gen, sova_win_len);</span>
<a name="l00086"></a>00086 <span class="stringliteral">            </span>
<a name="l00087"></a>00087 <span class="stringliteral">            %interleave</span>
<a name="l00088"></a>00088 <span class="stringliteral">            apriori_data = extrinsic_data(perm);</span>
<a name="l00089"></a>00089 <span class="stringliteral">            </span>
<a name="l00090"></a>00090 <span class="stringliteral">            %second decoder</span>
<a name="l00091"></a><a class="code" href="pccc_8m.html#5d4675ccc38f894c78ef8a732de07c85">00091</a> <span class="stringliteral">            [extrinsic_coded extrinsic_data] = ...</span>
<a name="l00092"></a>00092 <span class="stringliteral">                C_SISOrsc(dec2_intrinsic_coded, apriori_data, bin_gen, 0, map_metric);%no tail</span>
<a name="l00093"></a>00093 <span class="stringliteral">            %extrinsic_data = C_SISOsova(dec2_intrinsic_coded, apriori_data, bin_gen, sova_win_len);</span>
<a name="l00094"></a>00094 <span class="stringliteral"></span>
<a name="l00095"></a>00095 <span class="stringliteral">            %decision on a posteriori information</span>
<a name="l00096"></a>00096 <span class="stringliteral">            apriori_data = apriori_data+extrinsic_data;</span>
<a name="l00097"></a><a class="code" href="pccc_8m.html#357e565fc10f2b27f5474eb30c65117c">00097</a> <span class="stringliteral">            rec_bits = double(apriori_data(inv_perm)&gt;0);</span>
<a name="l00098"></a>00098 <span class="stringliteral">            </span>
<a name="l00099"></a>00099 <span class="stringliteral">            %deinterleave for the next iteration</span>
<a name="l00100"></a>00100 <span class="stringliteral">            apriori_data = extrinsic_data(inv_perm);</span>
<a name="l00101"></a>00101 <span class="stringliteral"></span>
<a name="l00102"></a>00102 <span class="stringliteral">            %threshold</span>
<a name="l00103"></a>00103 <span class="stringliteral">            apriori_data(apriori_data&gt;threshold) = threshold;</span>
<a name="l00104"></a>00104 <span class="stringliteral">            apriori_data(apriori_data&lt;-threshold) = -threshold;</span>
<a name="l00105"></a>00105 <span class="stringliteral">            </span>
<a name="l00106"></a>00106 <span class="stringliteral">            %count errors</span>
<a name="l00107"></a>00107 <span class="stringliteral">            BER(n,en) = BER(n,en)+nnz(bits-rec_bits)/perm_len;</span>
<a name="l00108"></a>00108 <span class="stringliteral"></span>
<a name="l00109"></a>00109 <span class="stringliteral">        end%end iterations</span>
<a name="l00110"></a><a class="code" href="pccc_8m.html#f7e56af625de7654082e405f017b4d9d">00110</a> <span class="stringliteral">        nb_errors = nb_errors+nnz(bits-rec_bits(1:perm_len));%get number of errors at the last iteration</span>
<a name="l00111"></a>00111 <span class="stringliteral">        nb_blocks = nb_blocks+1;</span>
<a name="l00112"></a>00112 <span class="stringliteral">    end%end blocks (while loop)</span>
<a name="l00113"></a>00113 <span class="stringliteral"></span>
<a name="l00114"></a>00114 <span class="stringliteral">    %compute BER over all tx blocks</span>
<a name="l00115"></a>00115 <span class="stringliteral">    BER(:,en) = BER(:,en)/nb_blocks;</span>
<a name="l00116"></a>00116 <span class="stringliteral"></span>
<a name="l00117"></a>00117 <span class="stringliteral">    %show progress</span>
<a name="l00118"></a>00118 <span class="stringliteral">    txtprogressbar(en/snr_len);</span>
<a name="l00119"></a>00119 <span class="stringliteral">end</span>
<a name="l00120"></a>00120 <span class="stringliteral"></span>
<a name="l00121"></a>00121 <span class="stringliteral">figure</span>
<a name="l00122"></a>00122 <span class="stringliteral">semilogy(EbN0_dB, BER, '</span>o-<span class="stringliteral">')</span>
<a name="l00123"></a>00123 <span class="stringliteral">grid on</span>
<a name="l00124"></a>00124 <span class="stringliteral">xlabel('</span>E_b/N_0 [dB]<span class="stringliteral">')</span>
<a name="l00125"></a>00125 <span class="stringliteral">ylabel('</span><a class="code" href="pccc_8m.html#4799e2ea2eeaf9ebc68bd4468b682670">BER</a><span class="stringliteral">')</span>
<a name="l00126"></a>00126 <span class="stringliteral"></span>
<a name="l00127"></a><a class="code" href="pccc_8m.html#be1b5217ffb43e4e6fae98a2910d9da0">00127</a> <span class="stringliteral">save(filename, '</span><a class="code" href="pccc_8m.html#4799e2ea2eeaf9ebc68bd4468b682670">BER</a><span class="stringliteral">', '</span><a class="code" href="pccc_8m.html#bc716b49b0c9588d89d80534d0b0b8ca">EbN0_dB</a><span class="stringliteral">', '</span><a class="code" href="pccc_8m.html#73103af02bc57db44fc54ad21c37ecd9">gen</a><span class="stringliteral">', '</span><a class="code" href="pccc_8m.html#24ee4b5453385f9ba93ead2a9623c539">R</a><span class="stringliteral">', '</span><a class="code" href="pccc_8m.html#be1b5217ffb43e4e6fae98a2910d9da0">nb_iter</a><span class="stringliteral">', ...</span>
<a name="l00128"></a>00128 <span class="stringliteral">    '</span><a class="code" href="pccc_8m.html#8b420c46ce5570ef92f50c779dace329">perm_len</a><span class="stringliteral">', '</span><a class="code" href="pccc_8m.html#2db14ef8a33e774589826a6f1e5fe516">nb_errors_lim</a><span class="stringliteral">', '</span><a class="code" href="pccc_8m.html#b1164bab531071886b608ea563393d26">perm_len_lim</a><span class="stringliteral">')</span>
</pre></div></div>
<hr size="1"><address style="text-align: right;"><small><a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border="0"></a> </small></address>
</body>
</html>
